<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RespiraWorks Ventilator: Testing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RespiraWorks Ventilator
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Testing </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This section contains testing information, including testing plans, and resulting data.</p>
<h1><a class="anchor" id="autotoc_md259"></a>
Test equipment</h1>
<p>The following custom in-house developed test equipment is used.</p>
<p>[DIY test lung](test_lung)</p>
<h1><a class="anchor" id="autotoc_md260"></a>
Testing data</h1>
<p>Some testing data is [here](testing-data)</p>
<h1><a class="anchor" id="autotoc_md261"></a>
Durability and Life-Leader Testing</h1>
<p><img src="images/life_leader.png" alt="" class="inline"/></p>
<p>To validate that the ventilator components are suitable for extended periods of continuous operation, we are setting up automated durability and life-leader tests. These tests will eventually cycle both individual components and assembled ventilators over time, measuring any change in performance. The goal is that these test units will have more cycles on them than any operational ventilators in the field, giving us confidence that the design can withstand continued operation.</p>
<p>Our Preliminary Life Leader Test has focused on the custom proportional pinch valve design and the blower, the two major moving parts in the ventilator. As discussed in more detail elsewhere, the pinch valve design results in cyclical stress both on the valve and on the tubing - a key question is how well the design will hold up over time. We have had one pinch valve running continuously for a few weeks and are doing performance testing to see how it compares to fresh valves. The blower operates at over 40,000 RPM and so also is a potential service life concern. This life leader testing incorportates partial wear life acceleration: the pinch valve operates at 60 cycles/minute at 0-100% actuation, whereas in actual ventilator use, the fastest rate will be 30 cycles/minute. The blower operates at 100% throttle, which is the highest throttle expected in practice. This means that every hour of this prelimiary life leader test is worth 2 hours of pinch valve operation and 1 hour of blower operations.</p>
<p>As of 2020.09.01, 1108 hours, had elapsed on the Preliminary Life Leader Test. This represents 3.99 million cycles on the pinch valve, representing at minimum 92 days of continuous ventilator operation at the highest setting of 30 bpm, equivalent to 2160 hours of continuous use. On the blower, this represents 46 days of continuous operation.</p>
<p><b><a href="https://github.com/RespiraWorks/Ventilator/tree/master/software/sample-data/2020-07-03-LifeLeader-594hrs-Performance-AIR">Link to 600hr Intermediate Life Leader Test</a></b></p>
<p>In the future, we will do Life Leader Testing on a full ventilator unit in order to provide a life leader for all the components.</p>
<h1><a class="anchor" id="autotoc_md262"></a>
Status of SiL (Software-in-the-Loop) Testing</h1>
<p>Software-in-the-loop testing is a way of testing the controller software with the modelica model such that software development is not held up by access to hardware (testing on actual hardware would be HIL (hardware-in-the-loop)). For a distributed team that may not have access to hardware, this can be a key way to allow the team to move quickly. Additionally, modelica models of new components can be developed based on their data sheets before they are acquired, allowing us to explore designs both cheaper (can evaluate components without buying them) and faster (can start updating the software before the new hardware arrives).</p>
<p>We have built out the infrastructure for interfacing our controller code with modelica and tested early prototypes. We are currently evaluating how best to integrate our existing controller code. Unfortunately, modelica relies on an earlier version of Visual Studio to compile the external controller for it to interact with, which means it does not support all of the C++ features that we are using. How best to work around this limitation without adding so much overhead that SIL testing becomes more work than it is worth is still to be determined.</p>
<p><a class="el" href="md__home_runner_work_Ventilator_Ventilator_design_modelica.html">More on modelica simulations</a></p>
<h1><a class="anchor" id="autotoc_md263"></a>
Status of Continuous Integration</h1>
<p>We have the following automatic or automated testing and continuous integration infrastructure currently set up:</p>
<ul>
<li>Cycle <a class="el" href="classController.html">Controller</a> and (New in v0.2) UI <a class="el" href="classController.html">Controller</a> unit tests being run on each commit. Only commits that pass tests can be merged. We use <a href="https://circleci.com/">CircleCI</a>, a popular continuous integration service.</li>
<li>(New in v0.2) Hardware-in-the-loop unit tests that developers can trigger manually using a shared server connected to a development build of the device or can run against their personal device.</li>
<li>(New in v0.2) The Cycle <a class="el" href="classController.html">Controller</a> debugger tool allows automating hardware-in-the-loop tests and was used to collect data for CoVent testing scenarios presented in 02-1 Performance Evaluation Report.</li>
<li>(New in v0.2) Continuous building of UI <a class="el" href="classController.html">Controller</a> Docker images, which also uses CircleCI.</li>
</ul>
<p>Our near term plans also include the following:</p>
<ul>
<li>Reporting of code coverage of unit tests</li>
<li>Optimizing GUI deployment with a loose coupling strategy to minimize update and development overhead:</li>
<li>Switching to Debian package management system</li>
<li>Unit tests for communications between the GUI and controller</li>
<li>Automate data analysis from unit tests to provide insight from test data</li>
</ul>
<h2><a class="anchor" id="autotoc_md264"></a>
Hardware-in-the-loop testing</h2>
<p>There is a strategy defined for <a class="el" href="md__home_runner_work_Ventilator_Ventilator_software_design_embedded_software_testing.html">embedded software testing</a>.</p>
<p>The goal of these tests is to test some subsets of our system with hardware on a regular basis and in a systematic way, to increase the likelihood of catching at least some problems early. These tests consider some cross-section of the hardware-software stack. To avoid the "fox watching the hen-house" situation, we have aimed at using an alternative hardware-software stack to confirm the performance of our system.</p>
<p>We are in the process of procuring all necessary components for this testing infrastructure, as well as building the automation software, however some of it is already available for developers.</p>
<p>In particular:</p>
<ul>
<li>We have set up a server connected to a build of the ventilator, which developers can access over ssh</li>
<li>We have written several tests that can be run against the device to confirm the functionality of the hardware abstraction layer of our software.</li>
<li>Multiple independent sensors have been procured to help confirm our code for pressure and flow sensing.</li>
<li>Modified pinch valves have been designed with additional sensors to confirm proper calibration and homing routines.</li>
<li>A Labjack data acquisition system has been obtained that will allow us to acquire validation data in an automated fashion.</li>
<li>The test units are powered via USB-controlled relays, allowing developers to remotely power cycle the test units.</li>
<li>A Jenkins CI server has been set up that will allow us to run all of these tests on a regular basis, same as software unit tests done in CircleCI.</li>
</ul>
<p>This testing lab will remain functional for the duration of further ventilator design through final product deployment and beyond, while any software development is taking place.</p>
<p><img src="../../manufacturing/pizza_build/images/3_pizzas_small.jpg" alt="" class="inline"/></p>
<p>Some of the developed test infrastructure will likely inform the development of validation and testing suites for the manufacturers of the final product.</p>
<p>More information about this infrastructure is available under <a href="../../software/controller/integration_tests">software/controller/integration_tests</a>.</p>
<h2><a class="anchor" id="autotoc_md265"></a>
System tests using the scriptable debug interface</h2>
<p>Additionally, we have built a debug interface into the device, and a Python-based command-line tool that can communicate with the device over that interface. The tool can be attached to the device even when the GUI is running.</p>
<p>Normally the debug tool is used simply for debugging (e.g. retrieving or overwriting values of certain system state variables or parameters, or collecting data traces), however it is scriptable and is also used for automating testing scenarios. As of writing, we have used the tool for automating the collection of test data for CoVent testing scenarios. We plan to expand its use to more automated tests and apply it as part of the shared hardware-in-the-loop testing infrastructure described above.</p>
<p>More information about the debug interface is available <a class="el" href="md__home_runner_work_Ventilator_Ventilator_software_utils_controller_debug.html">here</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
