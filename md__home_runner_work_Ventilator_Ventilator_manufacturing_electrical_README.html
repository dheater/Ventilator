<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RespiraWorks Ventilator: Electrical system assembly</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RespiraWorks Ventilator
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Electrical system assembly </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This build constitutes the computing and digital user interface components. It is enough to fully deploy and run all developed software, to test the GUI interface and possibly the communications protocol between controller and UI. Since it contains none of the sensors or drivers, system integration testing with this bare build is not possible. For an upgrade, check the <a href="../pizza_build">Pizza build</a>.</p>
<p>**#TODO:** add pictures</p>
<h1><a class="anchor" id="autotoc_md72"></a>
Parts</h1>
<p><b>Note: If you are a member of the RespiraWorks team, review the <a class="el" href="md__home_runner_work_Ventilator_Ventilator_manufacturing_purchasing_guidelines.html">part purchasing guidelines</a> BEFORE purchasing any parts.</b></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Item   </th><th class="markdownTableHeadRight">Quantity   </th><th class="markdownTableHeadNone">Manufacturer   </th><th class="markdownTableHeadNone">Part Number   </th><th class="markdownTableHeadRight">Price (USD)   </th><th class="markdownTableHeadCenter">Sources<a class="el" href="md__home_runner_work_Ventilator_Ventilator_manufacturing_purchasing_guidelines.html">*</a>   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>A1</b>   </td><td class="markdownTableBodyRight">1   </td><td class="markdownTableBodyNone">RespiraWorks   </td><td class="markdownTableBodyNone">PCB   </td><td class="markdownTableBodyRight"></td><td class="markdownTableBodyCenter"><a href="../../pcb">Rw</a>   </td><td class="markdownTableBodyNone">RespiraWorks custom PCB    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>A2</b>   </td><td class="markdownTableBodyRight">(1)   </td><td class="markdownTableBodyNone">RespiraWorks   </td><td class="markdownTableBodyNone">PCB_interim_board   </td><td class="markdownTableBodyRight"></td><td class="markdownTableBodyCenter"><a href="https://github.com/inceptionev/VentilatorRev1InterimDaughtercard">Rw</a>   </td><td class="markdownTableBodyNone">RespiraWorks Rev1 interim board <b>OPTIONAL</b>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>A3</b>   </td><td class="markdownTableBodyRight">(1)   </td><td class="markdownTableBodyNone">Duracell   </td><td class="markdownTableBodyNone">2016 3V   </td><td class="markdownTableBodyRight">1.67   </td><td class="markdownTableBodyCenter"><a href="https://www.amazon.com/Duracell-Lithium-Battery-lasting-battery/dp/B00006JPGV">Z</a>   </td><td class="markdownTableBodyNone">CR2016 battery, for interim board <b>OPTIONAL</b>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>A4</b>   </td><td class="markdownTableBodyRight">1   </td><td class="markdownTableBodyNone">ST Micro   </td><td class="markdownTableBodyNone">NUCLEO-L452-RE   </td><td class="markdownTableBodyRight">14.43   </td><td class="markdownTableBodyCenter"><a href="https://www.mouser.com/ProductDetail/STMicroelectronics/NUCLEO-L452RE?qs=sGAEpiMZZMtw0nEwywcFgEEYp888DlnM1Y5kGes2rJIHvcJjT1ZDkw%3D%3D">M</a> <a href="https://export.rsdelivers.com/product/stmicroelectronics/nucleo-l452re/stmicroelectronics-stm32-nucleo-64-mcu/1261775">R</a>   </td><td class="markdownTableBodyNone">STM32 Nucleo dev board, <b>DO NOT get the -P</b> version    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>A5</b>   </td><td class="markdownTableBodyRight">2   </td><td class="markdownTableBodyNone">Digikey   </td><td class="markdownTableBodyNone">X-NUCLEO-IHM03A1   </td><td class="markdownTableBodyRight">10.64   </td><td class="markdownTableBodyCenter"><a href="https://www.digikey.com/short/z442qt">K</a> <a href="https://www.mouser.com/ProductDetail/511-X-NUCLEO-IHM03A1">M</a>   </td><td class="markdownTableBodyNone">Stepper driver board    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>A6</b>   </td><td class="markdownTableBodyRight">(1)   </td><td class="markdownTableBodyNone">ST   </td><td class="markdownTableBodyNone">X-NUCLEO-IHM02A1   </td><td class="markdownTableBodyRight">15.00   </td><td class="markdownTableBodyCenter"><a href="https://www.st.com/en/ecosystems/x-nucleo-ihm02a1.html#sample-and-buy">S</a> <a href="https://export.rsdelivers.com/product/stmicroelectronics/x-nucleo-ihm02a1/stmicroelectronics-x-nucleo-ihm02a1-two-axis/1646982">R</a>   </td><td class="markdownTableBodyNone">Two-axis stepper driver board, <b>Alternative to 2x<code>[A5]</code></b>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>A7</b>   </td><td class="markdownTableBodyRight">1   </td><td class="markdownTableBodyNone">Raspberry Pi   </td><td class="markdownTableBodyNone">RPI4-MODBP-2GB   </td><td class="markdownTableBodyRight">53.23   </td><td class="markdownTableBodyCenter"><a href="https://www.mouser.com/ProductDetail/Raspberry-Pi/RPI4-MODBP-2GB-BULK?qs=%2Fha2pyFaduiq9oc0d1uK569Mu3%252BsSMVa9bhYkyZbjQ1oNl8pHrdrS2f8pDbixKgb">M</a>   </td><td class="markdownTableBodyNone">Raspberry Pi 4    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>A8</b>   </td><td class="markdownTableBodyRight">1   </td><td class="markdownTableBodyNone">Pastall   </td><td class="markdownTableBodyNone">PT2019120501   </td><td class="markdownTableBodyRight">9.99 / 40   </td><td class="markdownTableBodyCenter"><a href="https://www.amazon.com/Raspberry-Heatsink-Conductive-Adhesive-Aluminum/dp/B082RKKQ2D">Z</a>   </td><td class="markdownTableBodyNone">Heat sink for Rpi    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>A9</b>   </td><td class="markdownTableBodyRight">1   </td><td class="markdownTableBodyNone">SanDisk   </td><td class="markdownTableBodyNone">SDSQXAF-032G-GN6MA   </td><td class="markdownTableBodyRight">10.73   </td><td class="markdownTableBodyCenter"><a href="https://www.amazon.com/dp/B06XWMQ81P">Z</a>   </td><td class="markdownTableBodyNone">UHS-1 Class 10 micro SD, memory for Raspberry Pi    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>A10</b>   </td><td class="markdownTableBodyRight">1   </td><td class="markdownTableBodyNone">UPerfect   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyRight">49.00   </td><td class="markdownTableBodyCenter"><a href="https://www.aliexpress.com/item/4000747984746.html">A</a>   </td><td class="markdownTableBodyNone">7" capacitive touchscreen with speakers    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">**A11**   </td><td class="markdownTableBodyRight">1   </td><td class="markdownTableBodyNone">UGREEN   </td><td class="markdownTableBodyNone">B0773N757H   </td><td class="markdownTableBodyRight">6.99   </td><td class="markdownTableBodyCenter">[Z][a11amzn]   </td><td class="markdownTableBodyNone">USB-A to micro-USB cable, 1.5ft    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">**A12**   </td><td class="markdownTableBodyRight">1   </td><td class="markdownTableBodyNone">Seadream   </td><td class="markdownTableBodyNone">26121600   </td><td class="markdownTableBodyRight">7.00   </td><td class="markdownTableBodyCenter">[Z][a12amzn]   </td><td class="markdownTableBodyNone">microHDMI adapter    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">**A13**   </td><td class="markdownTableBodyRight">1   </td><td class="markdownTableBodyNone">C2G   </td><td class="markdownTableBodyNone">56781   </td><td class="markdownTableBodyRight">7.99   </td><td class="markdownTableBodyCenter">[Z][a13amzn]   </td><td class="markdownTableBodyNone">HDMI cable, 1ft    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">**A14**   </td><td class="markdownTableBodyRight">1   </td><td class="markdownTableBodyNone">Mean Well   </td><td class="markdownTableBodyNone">GSM160A12-R7B   </td><td class="markdownTableBodyRight">63.99   </td><td class="markdownTableBodyCenter">[K][a14key]   </td><td class="markdownTableBodyNone">12v Power supply adapter, medical grade, 11.5A    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">**A15**   </td><td class="markdownTableBodyRight">1   </td><td class="markdownTableBodyNone">Cablelera   </td><td class="markdownTableBodyNone">ZWACPCAY-10   </td><td class="markdownTableBodyRight">8.99   </td><td class="markdownTableBodyCenter">[Z][a15amzn]   </td><td class="markdownTableBodyNone">Hospital grade power cord   </td></tr>
</table>
<p><b>Note:</b> If you are feeling stingy, don't get the touchscreen <code>[A10]</code>. You can connect the RasPi to any monitor and use a mouse and keyboard to control it.</p>
<p><b>NOTE: Please also see [wiring guide](wiring) for manufacture of custom wiring harnesses.</b></p>
<h2><a class="anchor" id="autotoc_md73"></a>
Tools</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Item   </th><th class="markdownTableHeadLeft">Manufacturer   </th><th class="markdownTableHeadNone">Part number   </th><th class="markdownTableHeadRight">Price (USD)   </th><th class="markdownTableHeadCenter">Sources<a class="el" href="md__home_runner_work_Ventilator_Ventilator_manufacturing_purchasing_guidelines.html">*</a>   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>B1</b>   </td><td class="markdownTableBodyLeft">Anker   </td><td class="markdownTableBodyNone">68ANREADER-B2A   </td><td class="markdownTableBodyRight">12.99   </td><td class="markdownTableBodyCenter"><a href="https://www.amazon.com/Anker-Portable-Reader-RS-MMC-Micro/dp/B006T9B6R2">Z</a>   </td><td class="markdownTableBodyNone">microSD-USB adapter, for flashing RasPi images    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>B2</b>   </td><td class="markdownTableBodyLeft">Monoprice   </td><td class="markdownTableBodyNone">3896   </td><td class="markdownTableBodyRight">0.83   </td><td class="markdownTableBodyCenter"><a href="https://www.amazon.com/AmazonBasics-USB-2-0-Cable-Male/dp/B00NH13S44/">Z</a> <a href="https://www.monoprice.com/product?p_id=3896">O</a>   </td><td class="markdownTableBodyNone">USB-A to miniUSB-B cable, for programming the nucleo    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>B3</b>   </td><td class="markdownTableBodyLeft">VicTsing   </td><td class="markdownTableBodyNone">IC192305US   </td><td class="markdownTableBodyRight">23.99   </td><td class="markdownTableBodyCenter"><a href="https://www.amazon.com/VicTsing-Keyboard-Adjustable-Independent-Indicator/dp/B07TT3VN4X">Z</a>   </td><td class="markdownTableBodyNone">Wireless keyboard and mouse, for setting up Rpi, <b>OPTIONAL</b>   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md74"></a>
Assembly Instructions</h1>
<h2><a class="anchor" id="autotoc_md75"></a>
Custom wiring</h2>
<p>The ventilator assembly requires some custom wiring. Please use materials and instructions on the [wiring page](wiring) to prepare those custom components.</p>
<h2><a class="anchor" id="autotoc_md76"></a>
Main circuit board (PCB)</h2>
<p>Design and manufacturing files for the main board can be found on the <a href="../../pcb/rev1_export">PCB Rev1 page</a>.</p>
<p>Revision 1 of the custom circuit board (PCB) requires some modification to work with the current prototype. Please follow instructions on that page to make the necessary modifications.</p>
<p>If you are building an enclosed ventilator prototype, you may stop following the PCB instructions right before installation of the Raspberry Pi. Follow the sequence of steps below instead.</p>
<p>**#TODO:** does errata explain how to do the bodge wire?</p>
<h2><a class="anchor" id="autotoc_md77"></a>
Cycle controller</h2>
<p>The Nucleo dev board serves as the main cycle controller processor and is to be installed onto the PCB.</p>
<p>**#TODO:** move relevant parts of PCB doc and/or illustrate</p>
<h2><a class="anchor" id="autotoc_md78"></a>
Interim board</h2>
<p>You might want to install an interim board <code>[A2]</code> if you intend to test any of the following functionality:</p><ul>
<li>oxygen control</li>
<li>EEPROM nonvolatile memory</li>
<li>real-time clock</li>
</ul>
<p>Design and manufacturing files can be found in this <a href="https://github.com/inceptionev/VentilatorRev1InterimDaughtercard">separate repository</a>.</p>
<p>You will need to install a battery <code>[A3]</code>.</p>
<p>The card goes directly onto the Nucleo, <b>before</b> the stepper drivers.</p>
<p>You will probably also want to connect the oxygen sensor wire to this board before stacking the stepper drivers.</p>
<p>**#TODO:** pictures</p>
<h2><a class="anchor" id="autotoc_md79"></a>
Stepper drivers</h2>
<p>Pinch valves require either 2 stepper driver boards <code>[A5]</code> or a single 2-axis board <code>[A6]</code>.</p>
<p>Each pinch valve must also include some additional wiring and a driver board for controlling the stepper motor. A pigtail with male dupont connectors must be manufactured for interfacing to the driver board. Furthermore, since a single ventilator contains two pinch valves, each must come with its own driver board configured with 0-ohm resistors soldered appropriately.</p>
<p>It is advisable that you first manufacture the 2 pigtails of appropriate length as described on the [wiring page](wiring).</p>
<p>Stepper board modification and mounting to Nucleo is documented [here](stepper_drivers).</p>
<p>Now you can connect the steppers to their driver pigtails as follows:</p><ul>
<li>top - inhale</li>
<li>bottom - exhale</li>
</ul>
<h2><a class="anchor" id="autotoc_md80"></a>
Raspberry Pi</h2>
<p>The Raspberry Pi serves as the user interface computer for the ventilator.</p>
<p>Prior to installing it on the PCB, you should:</p><ul>
<li>install a heat sink <code>[A8]</code> on the processor</li>
<li>load the memory card <code>[A9]</code> with the standard <a href="https://www.raspberrypi.org/software/">RaspberryPi OS</a>, using a microSD adapter <code>[B1]</code></li>
<li>install memory card into the RaspberryPi</li>
<li>give it a keyboard and mouse <code>[B3]</code> or</li>
<li>alternatively, you can configure it for remote ssh control as described on our <a href="../../software/gui">GUI page</a>.</li>
</ul>
<p>Unless you are doing a <a href="../pizza_build">Pizza build</a>, you will <b>NOT</b> want to install the Raspberry Pi onto the PCB quite yet. You will first want to mount the PCB onto the touch-screen, as described on the <a href="../enclosed_build/display_panel">display panel sub-assembly</a> page.</p>
<h2><a class="anchor" id="autotoc_md81"></a>
Touch screen</h2>
<p>The touch screen needs two connections:</p><ul>
<li>RaspberryPi's <code>USB</code> to touchscreen's <code>5V+Touch</code> microUSB, using <code>[A11]</code></li>
<li>RaspberryPi's <code>microHDMI</code> to touchscreen's <code>HDMI IN</code>, using <code>[A12]</code> and <code>[A13]</code></li>
</ul>
<p>**#TODO:** pictures</p>
<h2><a class="anchor" id="autotoc_md82"></a>
Final wiring</h2>
<p>By this point you should have completed all the mechanical and pneumatic sub-assemblies of the ventilator.</p>
<ul>
<li>connect blower power and control wires to CPB</li>
<li>connect proportional solenoid to PCB</li>
<li>connect stepper motors to the stepper driver pigtails as follows:<ul>
<li>top - inhale</li>
<li>bottom - exhale</li>
</ul>
</li>
<li>connect power supply cable to PCB</li>
</ul>
<p>**#TODO:** pictures</p>
<p>You may also want to use <code>[B2]</code> to connect the controller to your PC from which you will be flashing controller firmware.</p>
<h2><a class="anchor" id="autotoc_md83"></a>
Power</h2>
<p>Once the ventilator is assembled, you may use <code>[A14]</code> and <code>[A15]</code> power it. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
